!function(e){function t(t){for(var a,i,l=t[0],s=t[1],c=t[2],d=0,f=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(u&&u(t);f.length;)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,l=1;l<n.length;l++){var s=n[l];0!==r[s]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={0:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;o.push([3,1]),n()}([,function(e,t,n){var a;
/*!
 * EventEmitter v5.1.0 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - http://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function n(){}var r=n.prototype,o=t.EventEmitter;function i(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function l(e){return function(){return this[e].apply(this,arguments)}}r.getListeners=function(e){var t,n,a=this._getEvents();if(e instanceof RegExp)for(n in t={},a)a.hasOwnProperty(n)&&e.test(n)&&(t[n]=a[n]);else t=a[e]||(a[e]=[]);return t},r.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},r.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},r.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,a=this.getListenersAsObject(e),r="object"==typeof t;for(n in a)a.hasOwnProperty(n)&&-1===i(a[n],t)&&a[n].push(r?t:{listener:t,once:!1});return this},r.on=l("addListener"),r.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},r.once=l("addOnceListener"),r.defineEvent=function(e){return this.getListeners(e),this},r.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},r.removeListener=function(e,t){var n,a,r=this.getListenersAsObject(e);for(a in r)r.hasOwnProperty(a)&&-1!==(n=i(r[a],t))&&r[a].splice(n,1);return this},r.off=l("removeListener"),r.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},r.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},r.manipulateListeners=function(e,t,n){var a,r,o=e?this.removeListener:this.addListener,i=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(a=n.length;a--;)o.call(this,t,n[a]);else for(a in t)t.hasOwnProperty(a)&&(r=t[a])&&("function"==typeof r?o.call(this,a,r):i.call(this,a,r));return this},r.removeEvent=function(e){var t,n=typeof e,a=this._getEvents();if("string"===n)delete a[e];else if(e instanceof RegExp)for(t in a)a.hasOwnProperty(t)&&e.test(t)&&delete a[t];else delete this._events;return this},r.removeAllListeners=l("removeEvent"),r.emitEvent=function(e,t){var n,a,r,o,i=this.getListenersAsObject(e);for(o in i)if(i.hasOwnProperty(o))for(n=i[o].slice(0),r=0;r<n.length;r++)!0===(a=n[r]).once&&this.removeListener(e,a.listener),a.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,a.listener);return this},r.trigger=l("emitEvent"),r.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},r.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},r._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},r._getEvents=function(){return this._events||(this._events={})},n.noConflict=function(){return t.EventEmitter=o,n},void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}(this||{})},,function(e,t,n){n(4),n(5),n(6),n(7),n(8),window.jQuery=n(9),n(10),n(11),n(12),window._=n(13),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(23),n(24),n(25),window.showdown=n(26),n(27),n(28),n(29),n(30),n(54),n(79),n(57),n(58),n(59),n(62),n(63),n(64),n(65),n(66),n(67),n(68),n(70),n(78)},,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,function(e,t){!function(e,t){"use strict";window.angular.module("ally",["ngAria","pascalprecht.translate","tmh.dynamicLocale","ally.templates"]).constant("allyAppName","accessibleversions").constant("allyI18nSupportedLocales",["ar","ca","cy","da","de","en","en_GB","en_US_pro","es","fi","fr","fr_CA","he","it","nb","nl","nn_NO","pl","pt","pt_BR","sv","tr"]).constant("allyI18nDefaultLocale","en")}(window)},function(e,t){!function(e){"use strict";window.angular.module("ally").config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self",new RegExp("https://[a-zA-Z0-9-]+.s3.?[a-zA-Z0-9-]*.amazonaws.com/.*")])}])}()},function(e,t){!function(e){"use strict";function t(){var e=document.location.search.substr(1).split("&").map(function(e){return e.split("=")}).filter(function(e){return"locale"===e[0]})[0];return void 0!==e?e[1]:null}function n(){return navigator.languages&&navigator.languages.length>0?navigator.languages[0]:navigator.language||navigator.userLanguage}function a(e){var t=e.replace(/-/g,"_").split("_"),n=t[0].toLowerCase();return t.length>1&&(n+="_"+t[1].toUpperCase()),t.length>2&&(n+="_"+t.slice(2).join("_")),n}function r(e){return o(e).toLowerCase()}function o(e){var t=e.split(/[-_]/),n=[];return n.push(t[0].toLowerCase()),t[1]&&n.push(t[1].toUpperCase()),n.join("-")}e.module("ally").service("allyI18nUtils",["$translate","allyI18nDefaultLocale",function(e,a){var i=["ar","he"];return{getInfo:function(){var r,l=e.preferredLanguage();return{direction:-1!==i.indexOf(l)?"rtl":"ltr",language:l,locale:o((r=a,t()||n()||r))}},toAngularLocale:r,toBcp47:o}}]),e.module("ally").config(["allyAppName","allyI18nSupportedLocales","allyI18nDefaultLocale","$translateProvider","tmhDynamicLocaleProvider",function(e,o,i,l,s){var c=function(e,r){var o=a(t()||n()||r),i=o.split("_")[0];if(-1!==e.indexOf(o))return o;if(-1!==e.indexOf(i))return i;var l=function(e,t){var n=e.filter(function(e){return e.split("_")[0]===t});return 1===n.length?n[0]:null}(e,i);return l||a(r)}(o,i),u=r(c);s.localeLocationPattern("/shared/lib/angular-i18n/angular-locale_{{locale}}.js"),s.defaultLocale(u),l.useLoader("i18nFactory"),l.useSanitizeValueStrategy("escapeParameters"),l.preferredLanguage(c),l.fallbackLanguage("en")}])}(window.angular)},function(e,t,n){!function(e){"use strict";window.angular.module("ally").factory("i18nFactory",["$http",function(e){return function(t){var a=n(31)("./"+t.key+".json");return e.get(a).then(function(e){return e.data})}}])}()},function(e,t,n){var a={"./ar.json":32,"./ca.json":33,"./cy.json":34,"./da.json":35,"./de.json":36,"./en.json":37,"./en_GB.json":38,"./en_US_pro.json":39,"./es.json":40,"./fi.json":41,"./fr.json":42,"./fr_CA.json":43,"./he.json":44,"./it.json":45,"./nb.json":46,"./nl.json":47,"./nn_NO.json":48,"./pl.json":49,"./pt.json":50,"./pt_BR.json":51,"./sv.json":52,"./tr.json":53};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=31},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/ar.7c0343875d72253613fd748c6efd51b8.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/ca.b48b65a28b34cf818e540b6f62b763b4.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/cy.083ad7dfcf443a6feacb7d2dd67aa5df.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/da.82d233255db2c80f9a81a3e64fda45ac.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/de.dd1e6001864fd7c7552a8768d288ad9b.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/en.525d5b2cfa1dabf0ff4fb6eb14a246bb.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/en_GB.0bbd15845fc645efba05ab47cfb035a9.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/en_US_pro.70c7f9c296cc64ada55e1839dcb69a4f.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/es.64298d2f4c193267afc411184055c54d.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/fi.4cc850f71ce7e2098424ef88614020b1.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/fr.8e6608e86d3891180e9d351ded83d3a4.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/fr_CA.f3141e151328b186dd33422b3f50c654.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/he.9d62bb60e76a604259c799878206bc47.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/it.87ee8b3e936a1a914fe505fae79d7b3d.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/nb.0e1e9cd7e8eceab321bfa1b74c694f0f.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/nl.035b00dc8f8100b2563599d0fef4e64d.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/nn_NO.a3fa9a92412829926bb497f4ce136f40.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/pl.703b3da860e962020951ef3ec00486e4.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/pt.951dceaf05b39bffceaa6cd1568ee7fd.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/pt_BR.802745b25205ade3d7f71f9a21535252.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/sv.d707ff45bbc70ca3cc574587bb519808.json"},function(e,t,n){e.exports=n.p+"static/accessibleversions/locale/tr.50343ec338a8111939e0479c4e3bd3ad.json"},function(e,t){!function(e,t){"use strict";e.module("ally").filter("markdown",["$sce",function(e){var n=new t.Converter;return function(t){var a=n.makeHtml(t||"");return e.trustAsHtml(a)}}])}(window.angular,window.showdown)},,,function(e,t){!function(e){"use strict";window.angular.module("ally").filter("range",function(){return function(e,t){t=parseInt(t,10);for(var n=0;n<t;n++)e.push(n);return e}})}()},function(e,t){!function(e){"use strict";window.angular.module("ally").service("AllyAnalytics",["AllyRestApi",function(e){var t={lmsType:null,clientId:null,courseId:null,fileId:null,fileType:null,platformUi:null,resourceUrl:null},n=function(e){return(e=Math.round(100*e)/100)<=.33?"low":e<=.66?"medium":1===e?"perfect":"high"};function a(e,t,n){return 1!==t&&(e.ruleName=n),e}var r=function(n,r,o,i){var l=i<o?"WORSE":i>o?"BETTER":"SAME",s={lmsType:t.lmsType,clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,alterationType:n,platformUi:t.platformUi,scoreBefore:o.toString(),scoreAfter:i.toString(),scoreChangeType:l};a(s,o,r),e.trackEvent("AlteredThroughInstructorFeedback",s)};return{config:function(e,n,a,r,o,i,l){t.lmsType=e.toString(),t.clientId=n.toString(),t.courseId=a.toString(),null!=r?t.fileId=r.toString():delete t.fileId,null!=o?t.fileType=o.toString():delete t.fileType,void 0!==i?t.platformUi=i:delete t.platformUi,void 0!==l?t.resourceUrl=l:delete t.resourceUrl},engageInstructorFeedback:function(r,o){var i={lmsType:t.lmsType,clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,platformUi:t.platformUi,score:o.toString(),scoreIndicatorRange:n(o)};a(i,o,r),e.trackEvent("EngageInstructorFeedback",i)},closeInstructorFeedback:function(r,o){var i={lmsType:t.lmsType,clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,platformUi:t.platformUi,score:o.toString(),scoreIndicatorRange:n(o)};a(i,o,r),e.trackEvent("CloseInstructorFeedback",i)},removeAlternativeDescription:function(e,t,n){r("RemoveAlternativeDescription",e,t,n)},addAlternativeDescription:function(e,t,n){r("AddAlternativeDescription",e,t,n)},editAlternativeDescription:function(e,t,n){r("EditAlternativeDescription",e,t,n)},setDecorative:function(e,t,n){r("SetDecorative",e,t,n)},unsetDecorative:function(e,t,n){r("UnsetDecorative",e,t,n)},addLibraryReference:function(e,t,n){r("AddLibraryReference",e,t,n)},removeLibraryReference:function(e,t,n){r("RemoveLibraryReference",e,t,n)},editLibraryReference:function(e,t,n){r("EditLibraryReference",e,t,n)},removeFile:function(e,t){r("RemoveFile",e,t,1)},addFile:function(e,t,n){r("AddFile",e,t,n)},addUnsupportedFile:function(n,r,o){var i={lmsType:t.lmsType,clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileTypeBefore:t.fileType,mimeType:o,alterationType:"AddUnsupportedFile",platformUi:t.platformUi,scoreBefore:r.toString()};a(i,r,n),e.trackEvent("AlteredThroughInstructorFeedback",i)},listWebpageLinks:function(){e.trackEvent("ListWebpageLinks",{clientId:t.clientId,courseId:t.courseId,lmsType:t.lmsType,platformUi:t.platformUi})},engageAlternativeFormat:function(n){e.trackEvent("EngageAlternativeFormat",{aafsEnabled:n.toString(),clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,lmsType:t.lmsType,platformUi:t.platformUi,resourceUrl:t.resourceUrl})},openLibraryReferenceLink:function(n){e.trackEvent("OpenLibraryReferenceAlternativeFormat",{clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,lmsType:t.lmsType,platformUi:t.platformUi,url:n})},beginDownloadAlternativeFormat:function(n,a){var r={clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,formatType:n,lmsType:t.lmsType,platformUi:t.platformUi,resourceUrl:t.resourceUrl};a&&(r.formatParam=a.formatParam),e.trackEvent("BeginDownloadAlternativeFormat",r)},cancelDownloadAlternativeFormat:function(n){e.trackEvent("CancelDownloadAlternativeFormat",{clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,formatType:n,lmsType:t.lmsType,platformUi:t.platformUi,resourceUrl:t.resourceUrl})},completeDownloadAlternativeFormat:function(n){e.trackEvent("CompleteDownloadAlternativeFormat",{clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,formatType:n,lmsType:t.lmsType,platformUi:t.platformUi,resourceUrl:t.resourceUrl})},needExtraHelp:function(n,a){e.trackEvent("NeedExtraHelp",{clientId:t.clientId,courseId:t.courseId,fileId:t.fileId,fileType:t.fileType,helpType:n,lmsType:t.lmsType,platformUi:t.platformUi,resourceUrl:t.resourceUrl,role:a})}}}])}()},function(e,t,n){var a=n(60),r=n(61);!function(e,t){"use strict";e.module("ally").service("utilService",["$q",function(e){var n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,o=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,i=[];window.addEventListener("message",function(e){var t=s(e.data);t&&i.forEach(function(e){e(t)})});var l=function(e,t,n,a){t=t||{};var r=e+"-"+Math.floor(1e6*Math.random()),o={subject:e,id:r,data:t,responseTo:n};if(window.parent.postMessage(JSON.stringify(o),"*"),a){window.addEventListener("message",function e(t){var n=s(t.data);if(n&&n.responseTo===r)return window.removeEventListener("message",e),a(n)})}},s=function(e){try{return JSON.parse(e)}catch(e){return null}};function c(e,n){var a=t('<span aria-hidden="true">').html(n);a.insertAfter(e);var r=a.width();return a.remove(),r}return{autoGrowIframe:function(){a.autoGrowIframe()},getScrollInformation:function(){var t=e.defer();if(a.isRunningInIframe())l("getScrollInformation",null,null,function(e){t.resolve(e.data)});else{var n=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),r=document.body.offsetHeight-n-document.documentElement.clientHeight;t.resolve({scrollPosition:n,scrollToBottom:r})}return t.promise},isMobileOrTablet:function(){var e=window.navigator,t=e.userAgent||e.vendor||window.opera;return n.test(t)||o.test(t.substr(0,4))},isRunningInIframe:a.isRunningInIframe,postDownloadReadyMessage:function(e){l("downloadReady",e)},postFixHtmlIssueMessage:function(e,t,n){l("fixHtmlIssue",{fixOptions:n,locators:t,ruleName:e})},postIFrameMessage:l,postPrintMessage:function(){l("print")},postReplacedFileMessage:function(e,t){l("replaceFile",{oldFileId:e&&e.toString(),newFile:t})},registerIFrameMessageCallback:function(e){i.push(e)},resizeDropdowns:function(e){t(e).each(function(){var e=t(this),n=e.find("option:selected").text(),a=c(e,n);e.width(a+20)})},textWidth:c,appendEesysoftScript:function(e){r.appendScript(e)}}}])}(window.angular,window.$)},function(e,t,n){"use strict";function a(){try{return window.self!==window.top}catch(e){return!0}}function r(){a()&&setInterval(o,250)}function o(){const e={height:document.body.offsetHeight+75,subject:"lti.frameResize"};window.parent.postMessage(JSON.stringify(e),"*")}n.r(t),n.d(t,"isRunningInIframe",function(){return a}),n.d(t,"autoGrowIframe",function(){return r})},function(e,t,n){"use strict";n.r(t),n.d(t,"appendScript",function(){return r});const a="\n    window.addEventListener(\"message\", function(e) {\n        if(e.data.eesysoftloader !== undefined) {\n            var __eesyEng = document.createElement('script');\n            __eesyEng.src = e.data.eesysoftloader;\n            __eesyEng.async = true;\n            __eesyEng.type = 'text/javascript';\n\n            var __element = document.getElementsByTagName('script')[0];\n            __element.parentNode.insertBefore(__eesyEng, __element);\n        }\n    }, false);\n\n    window.parent.postMessage({\n        messageName: \"lti.ready\",\n        supportTab: \"true\"\n    }, '*');\n";function r(e){const t=".ally-eesysoft-integration-script";e.querySelectorAll(t).forEach(e=>e.remove());const n=document.createElement("script");n.innerHTML=a,n.classList.add(t),e.appendChild(n)}},function(e,t){!function(e,t){"use strict";var n=["input:enabled","select:enabled","textarea:enabled","button:enabled","object","a[href]","area[href]","[tabindex]"];function a(t,n,a){var r=e(n);r.attr("tabindex",0).attr("aria-hidden","true"),r.on("focusin.ally-tab",function(e){var n=a.allyTabStart,r=a.allyTabStart||a.allyTabEnd,o={};n?o.last=!0:o.first=!0,t.$broadcast("ally-tab-"+r+"-focus",o),e.preventDefault()})}function r(t,n){if(n){var a=function(e){return e.find("[data-ally-tab-init],[ally-tab-init]").first()}(t);if(a[0])return a.focus(),a[0]}if(i(t))return t.focus(),t[0];var r=o(t)[0];return r?(e(r).focus(),r):void 0}function o(t){var a=[];return t.find(n.join(",")).filter(function(t,n){return i(e(n))}).each(function(e,t){a.push(t)}),a}function i(e){return e.is(n.join(","))&&function(e){return e.is(":visible")&&(!e.is("[tabindex]")||function(e){var t=parseInt(e.attr("tabindex"));return!isNaN(t)&&t>=0}(e))}(e)}t.module("ally")
/*!
   * An angular directive that can be used to prevent a user from tabbing outside of an area. This directive
   * should be used in conjunction with the `ally-tab-start` and `ally-tab-end` directives.
   *
   * Example:
   *
   * In the below example, when focus is moved into the `my-important-content` div, the focus will not be allowed
   * to travel to the input box or the "other action" button. It will continue cycling between the two buttons.
   *
   * ```
   * ...
   * <button>Other action</button>
   *
   * <!-- Focus should not be allowed to travel outside of this div
   * <div id="my-important-content">
   *     <div data-ally-tab-start="my-tab-container"></div>
   *     <div data-ally-tab="my-tab-container">
   *         <h1>So good</h1>
   *         <button>Yes</button>
   *         <button>No</button>
   *     </div>
   *     <div data-ally-tab-end="my-tab-container"></div>
   * </div>
   * ...
   * <input type="text" />
   * ```
   */.directive("allyTab",["$timeout",function(t){return{restrict:"A",controller:function(){var e=null;this.tab=function(){e=!0},this.shiftTab=function(){e=!1},this.tabReset=function(){e=null},this.isTabForward=function(){return!0===e},this.isTabBackward=function(){return!1===e}},link:function(n,a,i,l){var s=e(a);s.on("keydown.ally-tab",function(e){9===e.which?e.shiftKey?l.shiftTab():l.tab():l.tabReset()}),s.on("focusin.ally-tab",function(){l.tabReset()}),n.$on("ally-tab-"+i.allyTab+"-focus",function(n,a){t(function(){a=a||{};var t,n,c=(t=e('[data-ally-tab-start="'+i.allyTab+'"]'),n=e('[data-ally-tab-end="'+i.allyTab+'"]'),(0!==t.length&&0!==n.length&&t.siblings().is(n)?t.nextUntil(n):null)||a.target&&e(a.target)||s);a.first||l.isTabForward()?r(c,!1):a.last||l.isTabBackward()?function(t){var n=o(t);if(n.length>0){var a=n[n.length-1];e(a).focus()}}(c):r(c,!0)})})}}}])
/*!
   * An Angularjs directive that can be used to control whether an entire group of elements can be focussed. This
   * is particularly useful when one group of controls becomes hidden but not removed from the DOM (e.g. the IF
   * docs are layered on top of the regular IF controls).
   *
   * A panel can be (dis)activated by setting the `data-ally-tab-panel-active` attribute to a boolean value.
   *
   * For example, imagine a UI with two links in the menu and a form underneath. A modal-like view can be
   * triggered that gets layered above the form. When the modal is visible, the input fields in the form should
   * no longer be navigable.
   *
   * ```
   * <ul>
   *     <li><a href="#" data-ng-click="currentView = 'form'">Form</a></li>
   *     <li><a href="#" data-ng-click="currentView = 'modal'">Trigger a modal</a></li>
   * <ul>
   * <form data-ally-tab-panel data-ally-tab-panel-active="currentView === 'form'">
   *     From this form the following elements are tabbable:
   *      - The input fields in the form
   *      - The submit button
   *      - The two links in the menu above
   *
   *     <label>An input: <input type="text" />
   *     <label>Another input: <input type="text" />
   *     <button>Submit</button
   * </form>
   *
   * <div data-ng-if="currentView === 'modal'" data-ally-tab-panel
   *      data-ally-tab-panel-active="currentView === 'modal'">
   *     This div gets layered on top of the form, but onder the list. The only tabbable elements are:
   *      - The button in this modal
   *      - The link in this modal
   *      - The two links in the menu above
   *
   *     <a href="#">A link</a>
   *     <button data-ng-click="currentView = 'form'">Close me</button>
   * </div>
   * ```
   */.directive("allyTabPanel",["$timeout",function(t){return{restrict:"A",link:function(n,a,i){var l=e(a);function s(t){!1===t?(l.attr("aria-hidden","true"),o(l).forEach(function(t){var n=e(t);n.is("[tabindex]")?n.attr("data-ally-tab-prev-tabindex",n.attr("tabindex")):n.attr("data-ally-tab-prev-tabindex",""),n.attr("tabindex","-1")}),l.find("[data-ally-tab-init],[ally-tab-init]").removeAttr("data-ally-tab-init").removeAttr("ally-tab-init").attr("data-ally-tab-init-disabled","")):(l.attr("aria-hidden","false"),l.find("[data-ally-tab-prev-tabindex]").each(function(t,n){var a=e(n),r=a.attr("data-ally-tab-prev-tabindex");""===r?a.removeAttr("tabindex"):a.attr("tabindex",r),a.removeAttr("data-ally-tab-prev-tabindex")}),l.find("[data-ally-tab-init-disabled]").removeAttr("data-ally-tab-init-disabled").attr("data-ally-tab-init",""),r(l,!0))}n.$watch(i.allyTabPanelActive,function(e){t(s,50,!0,e)})}}}]).directive("allyTabStart",function(){return{restrict:"A",link:a}}).directive("allyTabEnd",function(){return{restrict:"A",link:a}})}(window.jQuery,window.angular)},function(e,t){!function(e,t){"use strict";e.module("ally").directive("allyTablist",["allyI18nUtils",function(e){return{restrict:"A",scope:{tablist:"=allyTablist"},link:function(n,a){n.moveFocus=function(r){var o="ArrowRight"===r.key,i="ArrowLeft"===r.key,l="ltr"===e.getInfo().direction?1:-1,s=o?l:i?-1*l:0,c=(n.currentFocus+n.tablist.length+s)%n.tablist.length;n.tablist[n.currentFocus].tabindex=-1,t(a).find("[ally-tablist-index="+c+"]")[0].focus(),n.currentFocus=c,n.tablist[n.currentFocus].tabindex=0},n.selectTab=function(e){n.tablist[e].select(),n.tablist[n.currentFocus].tabindex=-1,n.currentFocus=e,n.tablist[n.currentFocus].tabindex=0},n.tablist.forEach(function(e,t){e.index=t,e.tabindex=-1,e.selectTab=function(){n.tablist.forEach(function(e){e.isSelected=!1}),n.selectTab(e.index),e.isSelected=!0},e.moveFocus=function(t){"Enter"===t.key?e.selectTab():n.moveFocus(t)}});var r,o=(r=n.tablist.find(function(e){return e.isSelected}))?r.index:0;n.currentFocus=o,n.tablist[o].tabindex=0}}}])}(window.angular,window.$)},function(e,t){!function(e){"use strict";window.angular.module("ally.templates",[])}()},function(e,t){!function(e){"use strict";window.angular.module("ally").service("accessibleVersionsService",function(){var e={Enhanced:{title:"ENHANCED_VERSION",description:"ORIGINAL_FILE_WITH_AUTOMATED_IMPROVEMENTS"},Html:{title:"HTML",description:"FOR_VIEWING_IN_THE_BROWSER_AND_ON_MOBILE_DEVICES"},Pdf:{title:"TAGGED_PDF",description:"STRUCTURED_PDF_FOR_IMPROVED_USE_WITH_ASSISTIVE_TECHNOLOGY"},OcredPdf:{title:"OCRED_PDF",description:"AUTOMATICALLY_EXTRACTED_TEXT_FOR_IMPROVED_READING_AND_SEARCHING"},Epub:{title:"EPUB",description:"FOR_READING_AS_AN_E_BOOK"},Tts:{title:"AUDIO",description:"MP3_VERSION_FOR_LISTENING"},Braille:{title:"ELECTRONIC_BRAILLE",description:"BRF_VERSION_FOR_CONSUMPTION_ON_ELECTRONIC_BRAILLE_DISPLAYS"},Translation:{title:"TRANSLATION",description:"TRANSLATED_VERSION"},Beeline:{title:"BEELINE",description:"BEELINE_ENHANCED_VERSION"}};return{translateAlternativeVersion:function(t){return e[t]}}})}()},function(e,t){!function(e){"use strict";window.angular.module("ally").factory("accessibleVersionsFactory",["AllyRestApi","$q",function(e,t){function n(e,n){var a=t.defer();try{e.apply({},n.concat([function(e,t){e?a.reject(e):a.resolve(t)}]))}catch(e){a.reject(e)}return a.promise}return{getWebpageProfile:function(t){return n(e.getWebpageProfile,[t])},getAaasContentReport:function(t){return n(e.getAaasContentReport,[t,{formats:!0}])},getRichContentAssociatedFiles:function(t,a){return n(e.getRichContentAssociatedFiles,[t,a])},getIndividualRichContentReport:function(t){return n(e.getIndividualRichContentReport,[t,{formats:!0}])},getIndividualFileReport:function(t){return n(e.getIndividualFileReport,[{fileId:t},{formats:!0}])},disableAlternativeFormats:function(t,a){return n(e.disableAlternativeFormats,[t,a])},enableAlternativeFormats:function(t,a){return n(e.enableAlternativeFormats,[t,a])},sendExpertHelp:function(t,a,r,o){return n(e.sendAlternativeFormatsExpertHelp,[t,a,r,o])}}}])}()},function(e,t){!function(e,t,n,a){"use strict";var r=["OcredPdf","Pdf","Html","Epub","Braille","Tts","Beeline"],o={Beeline:"text/html",Braille:"text/plain",Epub:"application/epub+zip",Html:"text/html",OcredPdf:"application/pdf",Pdf:"application/pdf",Tts:"audio/mpeg"},i={brf:"text/plain",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",epub:"application/epub+zip",html:"text/html",mp3:"audio/mpeg",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rtf:"application/rtf"};e.module("ally").controller("AccessibleVersionsController",["accessibleVersionsService","accessibleVersionsFactory","AllyRestApi","AllyAnalytics","utilService","$q","$scope","$timeout","$window","$translate",function(e,l,s,c,u,d,f,p,m,v){var g;f.textDirection=(g=v.preferredLanguage(),-1!==["ar","he","iw"].indexOf(g)?"rtl":"ltr");var y,h=[{nativeName:"Afrikaans",nameToTranslate:"LANGUAGE_AFRIKAANS",value:"af"},{nativeName:"Shqip",nameToTranslate:"LANGUAGE_ALBANIAN",value:"sq"},{nativeName:"አማርኛ ",nameToTranslate:"LANGUAGE_AMHARIC",value:"am"},{nativeName:"العربية",nameToTranslate:"LANGUAGE_ARABIC",value:"ar"},{nativeName:"Հայերեն",nameToTranslate:"LANGUAGE_ARMENIAN",value:"hy"},{nativeName:"Azərbaycanca",nameToTranslate:"LANGUAGE_AZERBAIJANI",value:"az"},{nativeName:"বাংলা",nameToTranslate:"LANGUAGE_BENGALI",value:"bn"},{nativeName:"босански",nameToTranslate:"LANGUAGE_BOSNIAN_CYRILLIC",value:"bs"},{nativeName:"български",nameToTranslate:"LANGUAGE_BULGARIAN",value:"bg"},{nativeName:"català",nameToTranslate:"LANGUAGE_CATALAN",value:"ca"},{nativeName:"简化字",nameToTranslate:"LANGUAGE_CHINESE_SIMPLIFIED",value:"zh"},{nativeName:"繁體字",nameToTranslate:"LANGUAGE_CHINESE_TRADITIONAL",value:"zh-TW"},{nativeName:"Hrvatski",nameToTranslate:"LANGUAGE_CROATIAN",value:"hr"},{nativeName:"Čeština",nameToTranslate:"LANGUAGE_CZECH",value:"cs"},{nativeName:"Dansk",nameToTranslate:"LANGUAGE_DANISH",value:"da"},{nativeName:"درى (افغانستان)",nameToTranslate:"LANGUAGE_DARI",value:"fa-AF"},{nativeName:"Nederlands",nameToTranslate:"LANGUAGE_DUTCH",value:"nl"},{nativeName:"English",nameToTranslate:"LANGUAGE_ENGLISH",value:"en"},{nativeName:"Eesti",nameToTranslate:"LANGUAGE_ESTONIAN",value:"et"},{nativeName:"ﯽﺳﺭﺎﻓ",nameToTranslate:"LANGUAGE_FARSI",value:"fa"},{nativeName:"Wikang Tagalog",nameToTranslate:"LANGUAGE_TAGALOG",value:"tl"},{nativeName:"Suomi",nameToTranslate:"LANGUAGE_FINNISH",value:"fi"},{nativeName:"Français",nameToTranslate:"LANGUAGE_FRENCH",value:"fr"},{nativeName:"Français canadien",nameToTranslate:"LANGUAGE_FRENCH_CANADA",value:"fr-CA"},{nativeName:"ქართული",nameToTranslate:"LANGUAGE_GEORGIAN",value:"ka"},{nativeName:"Deutsch",nameToTranslate:"LANGUAGE_GERMAN",value:"de"},{nativeName:"Ελληνικά",nameToTranslate:"LANGUAGE_GREEK_MODERN",value:"el"},{nativeName:"ગુજરાતી ",nameToTranslate:"LANGUAGE_GUJARATI",value:"gu"},{nativeName:"Kreyòl ayisyen",nameToTranslate:"LANGUAGE_HAITIAN",value:"ht"},{nativeName:"هَوُسَ",nameToTranslate:"LANGUAGE_HAUSA",value:"ha"},{nativeName:"עברית",nameToTranslate:"LANGUAGE_HEBREW",value:"he"},{nativeName:"हिन्दी",nameToTranslate:"LANGUAGE_HINDI",value:"hi"},{nativeName:"Magyar",nameToTranslate:"LANGUAGE_HUNGARIAN",value:"hu"},{nativeName:"íslenska",nameToTranslate:"LANGUAGE_ICELANDIC",value:"is"},{nativeName:"Bahasa Indonesia",nameToTranslate:"LANGUAGE_INDONESIAN",value:"id"},{nativeName:"Italiano",nameToTranslate:"LANGUAGE_ITALIAN",value:"it"},{nativeName:"日本語",nameToTranslate:"LANGUAGE_JAPANESE",value:"ja"},{nativeName:"ಕನ್ನಡ",nameToTranslate:"LANGUAGE_KANNADA",value:"kn"},{nativeName:"Қазащb",nameToTranslate:"LANGUAGE_KAZAKH",value:"kk"},{nativeName:"한국어",nameToTranslate:"LANGUAGE_KOREAN",value:"ko"},{nativeName:"Latviešu",nameToTranslate:"LANGUAGE_LATVIAN",value:"lv"},{nativeName:"Latviešu",nameToTranslate:"LANGUAGE_LITHUANIAN",value:"lt"},{nativeName:"македонски јазик",nameToTranslate:"LANGUAGE_MACEDONIAN",value:"mk"},{nativeName:"Bahasa Malaysia",nameToTranslate:"LANGUAGE_MALAY",value:"ms"},{nativeName:"മലയാളം (ഭാരതം)",nameToTranslate:"LANGUAGE_MALAYALAM",value:"ml"},{nativeName:"Malti",nameToTranslate:"LANGUAGE_MALTESE",value:"mt"},{nativeName:"Монгол хэл",nameToTranslate:"LANGUAGE_MONGOLIAN",value:"mn"},{nativeName:"Bokmål",nameToTranslate:"LANGUAGE_NORWEGIAN",value:"no"},{nativeName:"پښتو",nameToTranslate:"LANGUAGE_PASHTO",value:"ps"},{nativeName:"Polski",nameToTranslate:"LANGUAGE_POLISH",value:"pl"},{nativeName:"Português",nameToTranslate:"LANGUAGE_PORTUGUESE",value:"pt"},{nativeName:"Româneşte",nameToTranslate:"LANGUAGE_ROMANIAN",value:"ro"},{nativeName:"Русский",nameToTranslate:"LANGUAGE_RUSSIAN",value:"ru"},{nativeName:"Српски",nameToTranslate:"LANGUAGE_SERBIAN_CYRILLIC",value:"sr"},{nativeName:"සිංහ",nameToTranslate:"LANGUAGE_SINHALA",value:"si"},{nativeName:"Slovenčina",nameToTranslate:"LANGUAGE_SLOVAK",value:"sk"},{nativeName:"Slovenščina",nameToTranslate:"LANGUAGE_SLOVENIAN",value:"sl"},{nativeName:"Soomaali",nameToTranslate:"LANGUAGE_SOMALI",value:"so"},{nativeName:"Español",nameToTranslate:"LANGUAGE_SPANISH",value:"es"},{nativeName:"Español mexicano",nameToTranslate:"LANGUAGE_SPANISH_MEXICAN",value:"es-MX"},{nativeName:"Kiswahili",nameToTranslate:"LANGUAGE_SWAHILI",value:"sw"},{nativeName:"Svenska",nameToTranslate:"LANGUAGE_SWEDISH",value:"sv"},{nativeName:"Tagalog",nameToTranslate:"LANGUAGE_TAGALOG",value:"tl"},{nativeName:"தமிழ்",nameToTranslate:"LANGUAGE_TAMIL",value:"ta"},{nativeName:"తెలుగు",nameToTranslate:"LANGUAGE_TELUGU",value:"te"},{nativeName:"ไทย",nameToTranslate:"LANGUAGE_THAI",value:"th"},{nativeName:"Türkçe",nameToTranslate:"LANGUAGE_TURKISH",value:"tr"},{nativeName:"Українська",nameToTranslate:"LANGUAGE_UKRAINIAN",value:"uk"},{nativeName:"اردو",nameToTranslate:"LANGUAGE_URDU",value:"ur"},{nativeName:"U'zbek",nameToTranslate:"LANGUAGE_UZBEK",value:"uz"},{nativeName:"Tiếng Việt",nameToTranslate:"LANGUAGE_VIETNAMESE",value:"vi"},{nativeName:"Cymraeg",nameToTranslate:"LANGUAGE_WELSH",value:"cy"}],b=!1,A=!0,T=!0;f.selectedVersion={value:null,language:h[0].value},f.links=null,v(t.map(h,"nameToTranslate"),"LANGUAGE_OPTION").then(function(e){return t(h).each(function(t){t.currentName=e[t.nameToTranslate]}),h=h.sort(function(e,t){return e.nativeName.localeCompare(t.nativeName)}),d.all(t.map(h,function(e){return v("LANGUAGE_AAF_DISPLAY_NAME",{native:e.nativeName,current:e.currentName})}))}).then(function(e){t.each(h,function(t,n){t.name=e[n]}),f.availableLanguages=h}),f.platformName=(y=/[?&]platformName=([^#&]+)/.exec(window.location.href))&&y[1],f.platformUi=function(){var e=/[?&]platformUi=([^#&]+)/.exec(window.location.href);return e&&e[1]}(),f.downloadState={name:null,data:null,downloadUrl:null},f.listAlternativeFormatsDeferral=null,f.termsOfUse=null,v("TERMS_OF_USE_LEGAL_COPY").then(function(e){f.termsOfUse=e}),f.helpType="DefaultHelp",f.needExtraHelp=function(){var e;switch(f.platformName){case"Wcm":e="008_001";break;case"web":e="007_006";break;default:e="007_003"}var t=/([a-z]{2})-([a-zA-Z]{2})/;k("https://help.blackboard.com/"+e+(t.test(f.locale)?t.exec(f.locale)[1]+"_"+t.exec(f.locale)[2]:/^\w{2}$/.test(f.locale)?f.locale+"_"+f.locale:"en_us")),c.needExtraHelp("DefaultHelp","Student")},a.setOption("openLinksInNewWindow",!0),a.setOption("headerLevelStart",3),f.openLibraryReferenceLink=function(e){k(e),c.openLibraryReferenceLink(e)},f.avTabs=[{select:function(){f.setModalView("downloadOptions")},isSelected:!0,iconClass:"ally-av-icon-download-options",spanClass:"ally-av-download-options",key:"DOWNLOAD_OPTIONS"},{select:function(){f.setModalView("libraryReference")},isSelected:!1,iconClass:"ally-av-icon-library-reference",spanClass:"ally-av-library-reference",key:"LIBRARY_REFERENCE"}],f.keydown=function(e){27===e.keyCode&&f.closeModal()},f.cancelDownload=function(e){"deferred"===f.downloadState.name&&f.downloadState.data.cancel(),f.downloadState.name&&c.cancelDownloadAlternativeFormat(f.selectedVersion.value),f.stateReset(e)},f.closeModal=x(function(){f.cancelDownload(!1),f.setModalView(null),f.links=null,n(".ally-av-modal").off("click",".ally-av-help-modal-content a"),u.postIFrameMessage("hide",{type:"accessibleVersions"})}),f.stateReset=x(function(e){f.downloadState.name=null,f.downloadState.data=null,f.downloadState.downloadUrl=null,f.avTabs.forEach(function(e){return e.isSelected=!1}),f.avTabs[0].isSelected=!0,e&&U()}),f.stateDefer=x(function(e){f.downloadState.name="deferred",f.downloadState.data=e,U(),p(function(){n(".ally-av-loading").css("z-index","0")})}),f.stateSucceed=x(function(e){f.completeDownload(e)}),f.stateCancel=x(function(){f.stateReset()}),f.stateFail=x(function(e){f.downloadState.name="failed",f.downloadState.data=e,401===e.code&&(f.downloadState.data.errorType="unauthorized"),U()}),f.setModalView=function(e){return f.listAlternativeFormatsDeferral&&(f.listAlternativeFormatsDeferral.cancel(),f.listAlternativeFormatsDeferral=null),f.modalView=e,U(),!1},S(),f.downloadAccessibleVersion=function(){var e=f.selectedVersion.value,t=null;"Translation"===e?t=f.selectedVersion.language:"Tts"!==e||"RichContent"!==f.selectedResource.uploadType||f.selectedDownload.url||(t=encodeURIComponent(f.selectedResource.title));var n=function(e,t){var n=["Translation","Html","Beeline"];if(-1!==n.indexOf(e)&&u.isMobileOrTablet())return!1;if(-1!==n.indexOf(e)&&-1!==["Wcm","web"].indexOf(t))return!1;return!0}(f.selectedVersion.value,f.platformName);c.beginDownloadAlternativeFormat(e,{formatParam:t});var a=function(e,t){if(e)return f.stateFail(e);if(t.url)return f.completeDownload(t.url);var n=t.emitter;f.stateDefer(n),n.on("finished",function(e){f.stateSucceed(e)}),n.on("error",function(e){f.stateFail(e)})};f.selectedDownload.AaaS?s.downloadAaasAlternativeVersion(f.selectedDownload.AaaS.contentHash,f.selectedDownload.AaaS.url,e,t,n,500,a):s.downloadAlternativeVersion(f.selectedDownload,e,t,n,500,a)},f.completeDownload=x(function(e){c.completeDownloadAlternativeFormat(f.selectedVersion.value),A&&"Tts"===f.selectedVersion.value&&u.isMobileOrTablet()?(f.downloadState.name="audio-player",f.downloadState.downloadUrl=e):(!function(e){var t=f.selectedVersion.value,n=null;"Translation"===t&&(n=f.selectedVersion.language);var a=o[t],r=function(e){return L(e,/https:\/\/.*\.amazonaws.com\/[A-Za-z0-9/]+[A-Za-z0-9-_]+\.([A-Za-z0-9]+)\?/)||L(e,/\/api\/v1\/downloads\/local\?key=[A-Za-z0-9/]+\.([A-Za-z]+)/)}(e);!a&&r&&i[r]&&(a=i[r]);var l={extension:r,format:t,formatMimeType:a,language:n,url:e};u.postDownloadReadyMessage(l)}(e),T?f.closeModal():f.stateReset())}),f.disableAlternativeFormats=function(){var e=f.selectedResource.uploadType;l.disableAlternativeFormats(e,f.selectedResource.id).then(function(){f.setModalView("aafsDisabled")})},f.enableAlternativeFormats=function(){var e=f.selectedResource.uploadType;l.enableAlternativeFormats(e,f.selectedResource.id).then(function(){f.setModalView("downloadOptions")})},f.sendExpertHelp=function(e){f.customHelpExpertEmailSubmitted.pending=!0,l.sendExpertHelp({id:f.selectedResource.id,name:f.selectedResource.name,type:f.selectedResource.mimeType,url:f.selectedResource.url},f.fromPageUrl,f.selectedVersion.value,e).then(function(){f.customHelpExpertEmailSubmitted.succeeded=!0}).catch(function(){f.customHelpExpertEmailSubmitted.succeeded=!1}).then(function(){f.customHelpExpertEmailSubmitted.completed=!0})},f.customHelpBack=function(){if(f.customHelpExpertEmailSubmitted.completed&&!f.customHelpExpertEmailSubmitted.succeeded)return delete f.customHelpExpertEmailSubmitted.pending,delete f.customHelpExpertEmailSubmitted.succeeded,void delete f.customHelpExpertEmailSubmitted.completed;f.setModalView("downloadOptions")},f.selectPage=I,f.selectFile=function(e){"web"===f.platformName?function(e){N(t.find(f.links,{id:e}),!0)}(e):function(e){var n=t.find(f.links,{id:e}),a=null;n&&n.title&&(a=n.title);_(e,a)}(e)},u.registerIFrameMessageCallback(function(e){"accessible-versions-show"===e.subject?w(e.data):"accessible-versions-focus"===e.subject?f.$broadcast("ally-tab-ally-av-focus"):"accessible-versions-reset"===e.subject&&f.stateReset(!1)}),u.postIFrameMessage("init",{type:"accessibleVersions"});var w=x(function(e){S("web"===f.platformName?"CHECKING_PAGE_ELLIPSIS":null),b=e.hasOpenUrlHandler;var a=e.opts;A=!1!==a.renderAudioOnMobileInline,T=!1!==a.closeWhenFormatReady,f.clientId=e.clientId,f.courseId=e.courseId,f.locale=e.opts.locale,f.fromPageUrl=e.fromPageUrl,s.init(e.clientId,e.courseId,function(){var a,r,o;n(document).on("click",".ally-av-terms-of-use",function(){f.setModalView("termsOfUse"),f.$apply()}),"web"===e.platformName?e.directFileInfo?(f.courseId="irrelevant",f.locale=e.opts.locale,f.fromPageUrl=e.fromPageUrl,f.canManageAafs=!1,f.pageProfile={},N(e.directFileInfo,!1)):function(e){l.getWebpageProfile(e.webpage).then(function(n){f.courseId=n.webpage.courseId,s.init(e.clientId,f.courseId),f.locale=e.opts.locale,f.fromPageUrl=e.fromPageUrl,f.canManageAafs=!1,f.pageProfile=n.webpage,c.config(f.platformName,f.clientId,f.courseId,void 0,void 0,f.platformUi),c.listWebpageLinks();var a=t.chain(e.webpage.links).zip(n.links).map(function(e,n){return t.extend(e[1],e[0],{index:n})}).filter(function(e){return!e.failed}).filter(function(e){return 0!==e.fileType.indexOf("html")}).filter(function(e){return e.supportsAlternativeFormats}).groupBy(function(e){return e.url}).values().map(function(e){return t.chain(e).orderBy(function(e){return[e.title||"",e.text||""]}).last().value()}).sortBy("index").value();a.length>0?(f.links=a,f.setModalView("pageWithFileLinks")):(f.links=null,E())}).catch(function(e){e.code>=400&&e.code<500&&f.setModalView("aafsDisabled")})}(e):"AaaS"===e.platformName?(f.courseId="irrelevant",f.locale=e.opts.locale,f.canManageAafs=!1,f.pageProfile={},o=e.contentInfo,l.getAaasContentReport(o.contentHash).then(function(e){f.selectedResource={id:o.contentHash,fileType:e.metadata.fileType,libraryReference:e.metadata.libraryReference,mimeType:e.metadata.mimeType,title:e.metadata.name,uploadType:"File"},f.selectedDownload={AaaS:o},R(f.selectedResource,e.formats.availableFormats,[],e.formats.canToggleAvailability),e.formats.available?f.setModalView("downloadOptions"):f.setModalView("aafsDisabled"),f.stateReset(),c.config(f.platformName,f.clientId,f.courseId,f.selectedResource.id,f.selectedResource.fileType,f.platformUi),c.engageAlternativeFormat(e.formats.available),u.postIFrameMessage("active",{type:"accessibleVersions"})})):"RichContent"===e.uploadType?(a=e.richContentId,r=e.associatedFiles,f.canManageAafs=!1,l.getIndividualRichContentReport(a).then(function(e){var t,n;return f.lmsRichContentReport=e,f.pageProfile=(t=e.id,n=e.metadata.name,{id:t,title:n,fileType:"html-fragment"}),e.formats.available?l.getRichContentAssociatedFiles(a,r).then(function(e){var t=e.results.filter(function(e){return e.supportsAlternativeFormats}).map(function(e){return t=e.externalId,n=e.title||e.fileName,a=e.fileType,{id:t,title:n,fileType:a,description:r};var t,n,a,r});c.config(f.platformName,f.clientId,f.courseId,void 0,void 0,f.platformUi),t.length>0?(f.links=t,f.setModalView("pageWithFileLinks")):(f.links=null,I())}):(I(),void f.setModalView("aafsDisabled"))}).catch(function(e){e.code>=400&&e.code<500&&f.setModalView("aafsDisabled")})):_(e.fileId),s.getHelp({targetGroup:"student"},function(e,a){e||"CustomHelp"===t.get(a,"helpType","DefaultHelp")&&(f.helpType="CustomHelp",n(".ally-av-modal").on("click",".ally-av-help-modal-content a",function(){return k(n(this).attr("href")),!1}),f.needExtraHelp=function(){f.customHelpExpertEmailSubmitted={},f.customHelp=t.get(a,["content","helpContent"],""),t.get(a,"content.expertEnabled")&&(f.customHelpExpertEmail=t.get(a,"content.expertEmail")),f.setModalView("customHelp"),c.needExtraHelp("CustomHelp","Student")})}),"canvas"!==f.platformName&&"learn"!==f.platformName||s.checkFeatureFlag("eesysoftIntegrationEnabled",function(e,t){!e&&t&&u.appendEesysoftScript(n(document).find("body")[0])})})});function I(){"web"===f.platformName?E():function(){f.selectedResource={availableAlternativeFormats:f.lmsRichContentReport.formats.availableFormats,fileType:"html-fragment",id:f.pageProfile.id,mimeType:"text/html",title:f.pageProfile.title,uploadType:"RichContent"},f.selectedDownload={lms:{clientId:f.clientId,courseId:f.courseId,uploadType:"RichContent",externalId:f.selectedResource.id}};c.config(f.platformName,f.clientId,f.courseId,f.selectedResource.id,f.selectedResource.fileType,f.platformUi,null),c.engageAlternativeFormat(!0),R(f.selectedResource,f.lmsRichContentReport.formats.availableFormats,[],f.lmsRichContentReport.formats.canToggleAvailability),f.setModalView("downloadOptions")}()}function E(){f.selectedResource={availableAlternativeFormats:null,fileType:f.pageProfile.fileType,id:f.pageProfile.id,mimeType:f.pageProfile.mimeType,title:f.pageProfile.title,uploadType:"RichContent",url:f.pageProfile.url},f.selectedDownload={url:f.pageProfile.url};c.config(f.platformName,f.clientId,f.courseId,f.selectedResource.id,f.selectedResource.fileType,f.platformUi,f.pageProfile.url),c.engageAlternativeFormat(!0),R(f.selectedResource,null),f.setModalView("downloadOptions")}function N(e,t){f.selectedResource={availableAlternativeFormats:null,fileType:e.fileType,href:e.href,id:e.id,mimeType:e.mimeType,text:e.text,uploadType:"File",url:t?e.url:null},f.selectedDownload={url:e.url};c.config(f.platformName,f.clientId,f.courseId,f.selectedResource.id,f.selectedResource.fileType,f.platformUi,e.url),c.engageAlternativeFormat(!0),R(f.selectedResource),f.setModalView("downloadOptions")}function R(a,o,i,l){if(i=i||{},f.canManageAafs=l||!1,o){if(a.availableAlternativeFormats=t.chain(o).sortBy(function(e){var n=t.indexOf(r,e);return-1===n?r.length:n}).filter(function(e){return!i[e]}).map(function(t){return{id:t,readableFormat:e.translateAlternativeVersion(t)}}).value(),!t.isEmpty(a.availableAlternativeFormats)){var c=f.selectedVersion.value;if(c)t.chain(a.availableAlternativeFormats).map("id").includes(c).value()||(f.selectedVersion.value=t.first(a.availableAlternativeFormats).id);else f.selectedVersion.value=t.first(a.availableAlternativeFormats).id}U()}else p(function(){n(".ally-av-loading").css("z-index","0")}),s.listAvailableFormats(f.selectedDownload,500,function(e,t){if(e)return f.stateFail(e);if(t.formats)return f.selectedResource.libraryReference=t.libraryReference,f.$apply(function(){R(a,t.formats,i)});var n=t.emitter;n.on("finished",function(e){f.$apply(function(){f.selectedResource.libraryReference=e.libraryReference,R(a,e.formats,i)})}),n.on("error",function(e){f.stateFail(e)}),f.listAlternativeFormatsDeferral=n})}function _(e,n){l.getIndividualFileReport(e).then(function(a){f.selectedResource={id:e,fileType:a.metadata.fileType,libraryReference:a.metadata.libraryReference,mimeType:a.metadata.mimeType,title:n||a.metadata.name,uploadType:"File"},f.selectedDownload={lms:{clientId:f.clientId,courseId:f.courseId,uploadType:"File",externalId:f.selectedResource.id}},!t.chain(a).get("metadata.libraryReference.url").isEmpty().value()&&!f.selectedResource.libraryReference.url.match(/^https?:\/\//)&&(f.selectedResource.libraryReference.url="http://"+f.selectedResource.libraryReference.url),R(f.selectedResource,a.formats.availableFormats,[],a.formats.canToggleAvailability),a.formats.available?f.setModalView("downloadOptions"):f.setModalView("aafsDisabled"),f.stateReset(),c.config(f.platformName,f.clientId,f.courseId,f.selectedResource.id,f.selectedResource.fileType,f.platformUi),c.engageAlternativeFormat(a.formats.available),u.postIFrameMessage("active",{type:"accessibleVersions"})})}function U(){f.$broadcast("ally-tab-ally-av-focus")}function L(e,t){var n=e.match(t);return n&&n.length>=2?n[1]:null}function S(e){f.loadingTitle=e||"DOWNLOAD_ALTERNATIVE_FORMATS",f.setModalView("loading"),p(function(){n(".ally-av-loading").css("z-index","0")})}function k(e){b?u.postIFrameMessage("openUrl",{url:e}):m.open(e,"_blank","noopener")}function x(e){return function(){var t=this,n=Array.prototype.slice.call(arguments);f.$$phase?e.apply(t,n):f.$apply(function(){e.apply(t,n)})}}}])}(window.angular,window._,window.jQuery,window.showdown)},function(e,t,n){!function(e){"use strict";var t=n(69);e.module("ally").directive("downloadLinkList",function(){return{restrict:"E",templateUrl:t,scope:{links:"=",onSelect:"="}}})}(window.angular)},function(e,t){var n="/accessibleversions/app/downloadlinklist/downloadlinklist.html";window.angular.module("ally.templates").run(["$templateCache",function(e){e.put(n,'<div class="downloadlinklist-container">\n    <ul>\n        <li data-ng-repeat="link in links">\n            <download-link data-link="link" on-select="onSelect"></download-link>\n        </li>\n    </ul>\n</div>\n')}]),e.exports=n},function(e,t,n){!function(e,t){"use strict";var a=n(71);function r(e){return e.title?e.title:e.text&&(0===(t=e.text).indexOf("/")||0===t.indexOf(".")||0===t.indexOf("http"))?o(e.text):e.text?e.text:o(e.href);var t}function o(e){var n=e.split("?").shift().split("#").shift();return t.chain(n.split("/")).compact().last()}e.module("ally").directive("downloadLink",function(){return{restrict:"E",templateUrl:a,scope:{link:"=",onSelect:"="},link:function(e,t,n){e.hasSelect=n.onSelect,e.hasControl=e.hasSelect},controller:["$scope",function(e){e.uiLink={description:e.link.url,id:e.link.id,title:r(e.link)},e.hasClickListener=void 0!==e.onSelect;e.uiLink.icon={type:"page"},-1!==["page","pdf","document","presentation","html-fragment"].indexOf(e.link.fileType)&&(e.uiLink.icon.type=e.link.fileType)}]}})}(window.angular,window._)},function(e,t,n){var a="/accessibleversions/app/downloadlink/downloadlink.html",r='<div class="downloadlink-container">\n    <a data-ng-attr-href="{{ onSelect ? \'#\' : undefined }}" data-ng-click="onSelect(uiLink.id)">\n        <div class="downloadlink-icon">\n            <img\n                data-ng-if="uiLink.icon.type === \'page\'"\n                src="'+n(72)+'"\n                aria-hidden="true"\n                class="downloadlink-icon-page">\n            <img\n                data-ng-if="uiLink.icon.type === \'pdf\'"\n                src="'+n(73)+'"\n                aria-hidden="true" />\n            <img\n                data-ng-if="uiLink.icon.type === \'document\'"\n                src="'+n(74)+'"\n                aria-hidden="true" />\n            <img\n                data-ng-if="uiLink.icon.type === \'presentation\'"\n                src="'+n(75)+'"\n                aria-hidden="true" />\n            <img\n                data-ng-if="uiLink.icon.type === \'html-fragment\'"\n                src="'+n(76)+'"\n                aria-hidden="true" />\n        </div>\n        <div class="downloadlink-description">\n            <span dir="ltr" class="downloadlink-description-title" data-ng-bind="uiLink.title"></span>\n            <span\n                dir="ltr"\n                class="downloadlink-description-subtitle"\n                data-ng-if="uiLink.description"\n                data-ng-bind="uiLink.description"></span>\n        </div>\n        <div class="downloadlink-control" data-ng-if="hasControl">\n            <img\n                data-ng-if="hasSelect"\n                src="'+n(77)+'"\n                aria-hidden="true" />\n        </div>\n    </a>\n</div>\n';window.angular.module("ally.templates").run(["$templateCache",function(e){e.put(a,r)}]),e.exports=a},function(e,t,n){e.exports=n.p+"static/iconCustomPage.7181a6d1f76263535bf7c5b91f1fd874.svg"},function(e,t,n){e.exports=n.p+"static/icon-filetype-pdf.922bf1a42f244bff09afd6ac2e1c7afc.svg"},function(e,t,n){e.exports=n.p+"static/icon-filetype-document.4a9c04ce52510e8f5b8d28816979289b.svg"},function(e,t,n){e.exports=n.p+"static/icon-filetype-presentation.a9ef89d2a14376f28bf00620dff2e29e.svg"},function(e,t,n){e.exports=n.p+"static/icon-filetype-wysiwyg.9d8388a7e78574f4d83af818363c9a35.svg"},function(e,t,n){e.exports=n.p+"static/iconArrowRight.11ea5efbd1c9e8f273869a6d8487a079.svg"},function(e,t){!function(e){"use strict";window.angular.module("ally").constant("allyI18nBundles",{})}()},function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"init",function(){return I}),n.d(a,"getRestApi",function(){return E}),n.d(a,"getFileInformation",function(){return N}),n.d(a,"generateHtmlFeedback",function(){return R}),n.d(a,"getIndividualFileReport",function(){return _}),n.d(a,"getIndividualRichContentReport",function(){return U}),n.d(a,"getAaasContentReport",function(){return L}),n.d(a,"getCourseReport",function(){return S}),n.d(a,"getEmbedInfo",function(){return k}),n.d(a,"enableAlternativeFormats",function(){return x}),n.d(a,"disableAlternativeFormats",function(){return F}),n.d(a,"getWebpageProfile",function(){return G}),n.d(a,"getRichContentAssociatedFiles",function(){return O}),n.d(a,"getDownloadUrl",function(){return C}),n.d(a,"saveMetadata",function(){return D}),n.d(a,"updateRichContentAltText",function(){return j}),n.d(a,"removeRichContentAltText",function(){return P}),n.d(a,"deleteFile",function(){return M}),n.d(a,"listAvailableFormats",function(){return H}),n.d(a,"downloadAlternativeVersion",function(){return V}),n.d(a,"downloadAaasAlternativeVersion",function(){return B}),n.d(a,"trackEvent",function(){return W}),n.d(a,"getHelp",function(){return K}),n.d(a,"sendInstructorFeedbackExpertHelp",function(){return q}),n.d(a,"sendAlternativeFormatsExpertHelp",function(){return Z}),n.d(a,"checkFeatureFlag",function(){return Y});var r={};n.r(r),n.d(r,"isAltTextMeaningful",function(){return ne}),n.d(r,"isTextSpecified",function(){return ae}),n.d(r,"isTextAFileName",function(){return re}),n.d(r,"isTextTheFileName",function(){return oe}),n.d(r,"getRoundedScore",function(){return ie}),n.d(r,"getHighChartFriendlyScore",function(){return le});var o=n(1),i={lmsType:null,baseUrl:null,clientId:null,courseId:null,lti13Id:null};function l(){return i.lmsType}function s(){return i.baseUrl}function c(){return i.clientId}function u(){return i.courseId}function d(){return i.lti13Id}var f=n(0);function p(e){this.interval=e||1e3,this._cancelled=!1,this._poll()}function m(e,t){this.interval=1e3,this.statusUrl=e,this.token=t,this._poll()}function v(e,t){this.processId=e,this.interval=t||1e3,this._poll()}p.prototype=Object.create(o.prototype),p.prototype.constructor=p,p.prototype.url=function(){throw new Error("url() method needs to be implemented")},p.prototype.headers=function(){return{}},p.prototype.states=function(){return{failed:"Failed",success:"Succeeded"}},p.prototype.cancel=function(){this._cancelled=!0,this.emit("cancelled")},p.prototype._poll=function(){var e=this;if(!e._cancelled){var t=e.url(),n=e.states(),a=e.headers();f.ajax({url:t,type:"GET",headers:a,crossDomain:!0,success:function(t){if(!e._cancelled)return t.status===n.success?e.emit("finished"):t.status===n.failed?e.emit("error",{code:500,msg:"Processing is reported to have failed"}):(e.emit("progress",t.status),setTimeout(function(){e._poll()},e.interval))},error:function(t,n){if(!e._cancelled)return e.emit("error",{code:n,msg:t.responseText})}})}},m.prototype=Object.create(p.prototype),m.prototype.constructor=m,m.prototype.url=function(){return this.statusUrl},m.prototype.states=function(){return{failed:"failed",success:"success"}},m.prototype.headers=function(){return{Authorization:`Bearer ${this.token}`}},v.prototype=Object.create(p.prototype),v.prototype.constructor=v,v.prototype.url=function(){return"/api/v1/processes/"+this.processId};var g=n(2);function y(){}function h(){}function b(){}function A(){}y.prototype._getJwtToken=function(e){var t=this,n=t._getJwtTokenFromSessionStorage();if(n)return e(null,n);t._getJwtTokenFromApi(function(n,a){return n?e(n):(t._setJwtTokenInSessionStorage(a),e(null,a))})},y.prototype._getJwtTokenFromApi=function(e){if(d()){var t=s().split("/"),n=t[0],a="institution."+t[2],r=encodeURIComponent(n+"//"+a+"/api/v2/auth/lti/1.3/target");this._getExternalToolFromApi(r,function(t,n){if(null!=t)return e(t);var a=g(n),r=Date.now(),o="/api/lti/authorize?lti_message_hint="+a.lti_message_hint+"&client_id="+d()+"&redirect_uri="+s()+"/api/v2/auth/lti/1.3/callback&login_hint="+a.login_hint+"&nonce="+r+"&scope=openid&response_type=id_token&response_mode=form_post&prompt=none";f.ajax({url:o,dataType:"html",success:function(t){var n=f.parseHTML(t).find(function(e){return"authorization_redirect_form"===e.id}),a=n&&f(n).find("#id_token"),r=a&&a.attr("value");return null!=r?e(null,r):e({msg:"Failed to authenticate user."})},error:function(t){return e({code:t.status,msg:t.responseText})}})})}else{var o=encodeURIComponent(s()+"/api/v1/"+c()+"/lti/institution");this._getExternalToolFromApi(o,e)}},y.prototype._getExternalToolFromApi=function(e,t){f.ajax({url:"/api/lti/courses/"+u()+"/jwt_token?tool_launch_url="+e,dataType:"json",success:function(e){return t(null,e.jwt_token)},error:function(e){return t({code:e.status,msg:e.responseText})}})},y.prototype._getJwtTokenFromSessionStorage=function(){var e=this._getSessionJwtKey(),t=window.sessionStorage.getItem(e);if(!t)return null;var n=null;try{n=JSON.parse(t),g(n.token)}catch(e){return null}var a=Date.now()-18e5;return n.timeStamp<a?null:n.token},y.prototype._setJwtTokenInSessionStorage=function(e){var t=this._getSessionJwtKey();try{window.sessionStorage.setItem(t,JSON.stringify({token:e,timeStamp:Date.now()}))}catch(e){}},y.prototype._getSessionJwtKey=function(){var e=window.ENV.current_user_id||"";return["ally","jwt",c(),u(),e,this._getRole()].join(".")},y.prototype._getRole=function(){if(-1!==(window.ENV.current_user_roles||[]).indexOf("admin"))return"administrator";var e=window.ENV.FILES_CONTEXTS||[],t=e&&e[0]&&e[0].permissions&&(e[0].permissions.manage_files_add||e[0].permissions.manage_files_delete||e[0].permissions.manage_files_edit);return(window.ENV.WIKI_RIGHTS||{}).update||t?"course-administrator":window.ENV.current_user_id?"student":"anonymous"},y.prototype.sign=function(e,t,n,a){this._getJwtToken(function(e,r){if(e)return a(e);var o={url:s()+t,headers:{Authorization:"Bearer "+r},parameters:n};return a(null,o)})},y.prototype.http=function(e,t,n,a,r){a=a||{};this._getJwtToken(function(o,i){if(o)return r(o);var l={url:s()+t,type:e,crossDomain:!0,xhrFields:{withCredentials:!1},data:n,success:function(e){return r(null,e)},error:function(e){return r({code:e.status,msg:e.responseText})}};l.headers=a.headers||{},l.headers.Authorization="Bearer "+i,a.contentType&&(l.contentType=a.contentType),f.ajax(l)})},y.prototype.getDownloadUrl=function(e,t){return t(null,window.location.protocol+"//"+window.location.host+"/files/"+e+"/download?download_frd=1")},h.prototype.sign=function(e,t,n,a){return a(null,{url:s()+t,headers:{Authorization:"Bearer "+this._getJwtToken()},parameters:n})},h.prototype.http=function(e,t,n,a,r){a=a||{};var o={url:s()+t,type:e,crossDomain:!0,xhrFields:{withCredentials:!1},data:n,success:function(e){return r(null,e)},error:function(e,t){return r({code:t,msg:e.responseText})}};o.headers=a.headers||{},o.headers.Authorization="Bearer "+this._getJwtToken(),a.contentType&&(o.contentType=a.contentType),f.ajax(o)},h.prototype.getDownloadUrl=function(e,t){return t({code:501,msg:"Learn does not support direct downloads"})},h.prototype._getJwtToken=function(){return window.ALLY_TOKEN},b.prototype.sign=function(e,t,n,a){return a(null,{url:s()+t,headers:{Authorization:"Bearer "+this._getJwtToken()},parameters:n})},b.prototype.http=function(e,t,n,a,r){a=a||{};var o={url:s()+t,type:e,crossDomain:!0,xhrFields:{withCredentials:!1},data:n,success:function(e){return r(null,e)},error:function(e,t){return r({code:t,msg:e.responseText})}};o.headers=a.headers||{},o.headers.Authorization="Bearer "+this._getJwtToken(),a.contentType&&(o.contentType=a.contentType),f.ajax(o)},b.prototype.getDownloadUrl=function(e,t){return t({code:501,msg:"Moodle does not support direct downloads"})},b.prototype._getJwtToken=function(){return window.require.s.contexts._.require("filter_ally/ally").token()},A.prototype.http=function(e,t,n,a,r){this._send("http",e,t,n,a,r)},A.prototype.sign=function(e,t,n,a){this._send("sign",e,t,n,null,a)},A.prototype.getDownloadUrl=function(e,t){this._send("getDownloadUrl",null,null,{fileId:e},null,t)},A.prototype._send=function(e,t,n,a,r,o){var i={subject:e,id:"iframe-api-"+Math.floor(1e6*Math.random()),data:{method:t,path:n,parameters:a,opts:r}},l=function(e){var t=T(e);if(t&&t.responseTo===i.id)return window.removeEventListener("message",l),o(t.data.err,t.data.response)};window.addEventListener("message",l),window.parent.postMessage(JSON.stringify(i),"*")};var T=function(e){if(!e||!e.data)return null;try{return JSON.parse(e.data)}catch(e){return null}};let w=null;function I(){switch(l()){case"canvas":w=new y;break;case"learn":w=new h;break;case"moodle":w=new b;break;case"iframe":w=new A;break;default:throw new Error("Unsupported LMS type specified: "+l())}}function E(){if(null!==w)return w;throw new Error("Rest API was not initialized yet. Have you called .init()?")}function N(e,t,n){t=t||{};const a=e.map(function(e){return e.data()}),r=encodeURIComponent(u());let o="/api/v1/"+c()+"/reports/courses/"+r+"/content";!0!==t.forceInstructorFeedbackEnabled&&!1!==t.forceInstructorFeedbackEnabled||(o+="?forceInstructorFeedbackEnabled="+t.forceInstructorFeedbackEnabled),w.http("POST",o,JSON.stringify(a),{contentType:"application/json"},function(e,t){if(e)return n(e);const a={uploadsReport:t.uploadsReport.map(function(e){return e&&null!==e.libraryReference&&(e.libraryReference=ee(e.libraryReference)),e}),flags:t.flags};return n(null,a)})}function R(e,t){w.http("POST",`/api/v1/${c()}/content/generateFeedback/html`,JSON.stringify({html:e}),{contentType:"application/json"},t)}function _(e,t,n){t=t||{};const a=encodeURIComponent(u()),r=encodeURIComponent(e.fileId);var o="/api/v2/clients/"+c()+"/courses/"+a+"/files/"+r+"/report";const i=[];if("string"==typeof t.uploadType&&i.push(`uploadType=${t.uploadType}`),"boolean"==typeof t.feedback&&i.push(`feedback=${t.feedback}`),"boolean"==typeof t.formats&&i.push(`formats=${t.formats}`),void 0!==e.embed){const t=encodeURIComponent(JSON.stringify(e.embed));i.push(`embed=${t}`)}const l=o+"?"+i.join("&");w.http("GET",l,null,{},function(e,t){if(!e&&t&&t.metadata&&"string"==typeof t.metadata.libraryReference)try{t.metadata.libraryReference=JSON.parse(t.metadata.libraryReference)}catch(e){}return n(e,t)})}function U(e,t,n){t=t||{};const a=encodeURIComponent(u()),r=encodeURIComponent(e);var o="/api/v2/clients/"+c()+"/courses/"+a+"/rich-content/"+r+"/report";const i=[];"boolean"==typeof t.feedback&&i.push(`feedback=${t.feedback}`),"boolean"==typeof t.formats&&i.push(`formats=${t.formats}`);const l=o+"?"+i.join("&");w.http("GET",l,null,{},n)}function L(e,t,n){t=t||{};var a="/api/v2/clients/"+c()+"/content/"+e;const r=[];"boolean"==typeof t.feedback&&r.push(`feedback=${t.feedback}`),"boolean"==typeof t.formats&&r.push(`formats=${t.formats}`);const o=a+"?"+r.join("&");w.http("GET",o,null,{},function(e,t){if(!e&&t&&t.metadata&&"string"==typeof t.metadata.libraryReference)try{t.metadata.libraryReference=JSON.parse(t.metadata.libraryReference)}catch(e){}return n(e,t)})}function S(e){var t=encodeURIComponent(u()),n="/api/v1/"+c()+"/reports/courses/"+t;w.http("GET",n,null,{},e)}function k(e,t,n){const a=encodeURIComponent(u()),r="RichContent"===e?"rich-content":"files",o=encodeURIComponent(t),i=`/api/v1/${c()}/courses/${a}/${r}/${o}/embedInfo`;w.http("GET",i,null,{},n)}function x(e,t,n){const a=encodeURIComponent(u()),r=encodeURIComponent(t),o="RichContent"===e?"rich-content":"files",i=["/api/v1",c(),"courses",a,o,r,"enableAlternativeFormats"].join("/");w.http("POST",i,null,{},n)}function F(e,t,n){const a=encodeURIComponent(u()),r=encodeURIComponent(t),o="RichContent"===e?"rich-content":"files",i=["/api/v1",c(),"courses",a,o,r,"disableAlternativeFormats"].join("/");w.http("POST",i,null,{},n)}function G(e,t){var n="/api/v1/"+c()+"/webpageProfile";w.http("POST",n,JSON.stringify({webpage:e}),{contentType:"application/json"},t)}function O(e,t,n){t=t||[];const a=encodeURIComponent(u()),r=encodeURIComponent(e),o=["/api/v2/clients",c(),"courses",a,"rich-content",r,"files"].join("/");w.http("POST",o,JSON.stringify(t),{contentType:"application/json"},n)}function C(e,t){var n=encodeURIComponent(u()),a=encodeURIComponent(e),r="/api/v1/"+c()+"/courses/"+n+"/files/"+a+"/download";w.http("GET",r,null,{headers:{Accept:"application/json"}},function(e,n){return e?t(e):n&&n.url?t(null,n.url):t({code:404,msg:"Missing download url"})})}function D(e,t,n){var a=encodeURIComponent(u()),r=encodeURIComponent(e),o="/api/v1/"+c()+"/courses/"+a+"/files/"+r;w.http("POST",o,t,null,function(e,t){return e?n(e):(t.libraryReference&&"string"==typeof t.libraryReference&&(t.libraryReference=ee(t.libraryReference)),n(null,t))})}function j(e,t,n,a,r,o){var i=encodeURIComponent(u()),l="/api/v1/"+c()+"/courses/"+i+"/rich-content/"+e+"/alt-text",s={fileId:t,locator:n,index:a,newAltText:r};w.http("POST",l,s,null,o)}function P(e,t,n,a,r){var o=encodeURIComponent(u()),i="/api/v1/"+c()+"/courses/"+o+"/rich-content/"+e+"/alt-text",l={fileId:t,locator:n,index:a};w.http("DELETE",i,l,null,r)}function M(e,t){var n=encodeURIComponent(u()),a="/api/v1/"+c()+"/courses/"+n+"/files/"+e;w.http("DELETE",a,{},null,t)}function H(e,t,n){var a="/api/v1/"+c()+"/content/listAvailableFormats",r=JSON.stringify({download:e});w.http("POST",a,r,{contentType:"application/json"},function(a,r){if(a)return n(a);if("Failed"===r.status)return n({msg:r.message,errorType:r.errorType});if(r.status&&t){var i=new o,l=new v(r.process_id||r.processId,t);return l.on("progress",function(e){i.emit("progress",e)}),i.cancel=function(){l.cancel()},l.on("cancelled",function(){i.emit("cancelled")}),l.on("error",function(){Q(e,i)}),l.on("finished",function(){Q(e,i)}),n(null,{emitter:i})}return r.status?n({code:500,msg:"Expected immediate response"}):r.formats?n(null,{formats:r.formats,libraryReference:r.libraryReference}):n({code:500,msg:"Unexpected response (no status and no available formats)"})})}function V(e,t,n,a,r,i,l,s){if((l=l||1)>3)return i({msg:"Surpassed maximum number of process deferals",errorType:"generic"});var u=null,d="/api/v1/"+c(),f=null,p=null;if(e.url)u="POST",d+="/content/convert",f=JSON.stringify({asAttachment:a,download:e,format:{name:t,options:{formatParam:n}},acceptTermsOfUse:!0}),p={contentType:"application/json"};else{const r=encodeURIComponent(e.lms.courseId);u="GET";const o=encodeURIComponent(e.lms.externalId);"RichContent"===e.lms.uploadType?d+="/courses/"+r+"/rich-content/"+o+"/formats/"+t:d+="/formats/"+r+"/"+o+"/"+t,f={acceptTOU:!0,formatParam:n,asAttachment:a},p=null}w.http(u,d,f,p,function(c,u){if(c)return i(c);if("Failed"===u.status)return i({msg:u.message,errorType:u.errorType});if(u.status&&r){s=s||new o;var d=new v(u.processId,r);return d.on("progress",function(e){s.emit("progress",e)}),s.cancel=function(){d.cancel()},d.on("cancelled",function(){s.emit("cancelled")}),d.on("error",function(){X(e,t,n,a,r,l,s)}),d.on("finished",function(){X(e,t,n,a,r,l,s)}),i(null,{emitter:s})}return u.status?i({code:500,msg:"Expected immediate response"}):u.url?i(null,{url:u.url}):i({code:500,msg:"Unexpected response (no status and no url)"})})}function B(e,t,n,a,r,i,l,s,u){if((s=s||1)>3)return l({msg:"Surpassed maximum number of process deferals",errorType:"generic"});J(function(s,d){if(s)return l(s);!function(e,t,n,a,r){var o="/api/v2/clients/"+c()+"/content/"+e+"/formats/"+n,i={formatParam:a,url:t};w.http("POST",o,i,null,r)}(e,t,n,a,function(e,t){if(e)return l(e);if("Failed"===t.status)return l({msg:t.error.message,errorType:t.error.type});if(t.downloadUrl)return z(t.downloadUrl,r,function(e,t){return e?l({msg:"Unable to retrieve JWT token"}):l(null,{url:t})});if(t.status&&i){u=u||new o;var n=new m(t.statusUrl,d);return n.on("progress",function(e){u.emit("progress",e)}),u.cancel=function(){n.cancel()},n.on("cancelled",function(){u.emit("cancelled")}),n.on("error",function(){$(t.statusUrl,r,u)}),n.on("finished",function(){$(t.statusUrl,r,u)}),l(null,{emitter:u})}return t.status?l({code:500,msg:"Expected immediate response"}):l({code:500,msg:"Unexpected response (no status and no url)"})})})}function $(e,t,n){w.http("GET",e,null,null,function(e,a){return e?n.emit("error",e):"failed"===a.status?n.emit("error",{msg:a.error.message,errorType:a.error.type}):"success"===a.status?z(a.downloadUrl,t,function(e,t){if(e)return n.emit("error",e);n.emit("finished",t)}):void 0})}function z(e,t,n){J(function(a,r){if(a)return n(a);const o=`${s()}${e}?asAttachment=${t}&jwt=${r}`;return n(null,o)})}function J(e){w.sign("GET","/",null,function(t,n){if(t)return e(t);const a=n.headers.Authorization.split(" ").pop();return e(null,a)})}function W(e,t,n){n=n||function(){};var a="/api/v1/"+c()+"/events",r={name:e,properties:t};w.http("POST",a,JSON.stringify(r),{contentType:"application/json"},n)}function K(e,t){var n="/api/v1/"+c()+"/help";w.http("GET",n,e,null,t)}function q(e,t,n,a,r){r=r||{};var o=encodeURIComponent(u()),i=encodeURIComponent(e),l="/api/v1/"+c()+"/courses/"+o+"/files/"+i+"/help/sendExpertInstructorFeedbackHelp",s={currentIssue:n,fromPageUrl:t};a&&(s.message=a),w.http("POST",l,s,null,r)}function Z(e,t,n,a,r){r=r||{};var o=encodeURIComponent(u()),i=encodeURIComponent(e.id),l="/api/v1/"+c()+"/courses/"+o+"/files/"+i+"/help/sendExpertAlternativeFormatsHelp",s={currentFormat:n,fromPageUrl:t};e.name&&(s.fileName=e.name),e.type&&(s.fileType=e.type),e.url&&(s.fileUrl=e.url),a&&(s.message=a),w.http("POST",l,s,null,r)}function Y(e,t){const n=`/api/v1/${c()}/feature/${e}`;w.http("GET",n,{},{},t)}function X(e,t,n,a,r,o,i){V(e,t,n,a,r,function(e,t){return e?i.emit("error",e):t.url?i.emit("finished",t.url):void 0},o+1,i)}function Q(e,t){H(e,null,function(e,n){if(e)return t.emit("error",e);if(n.formats){const e={formats:n.formats,libraryReference:n.libraryReference};return t.emit("finished",e)}})}function ee(e){if(e)try{return JSON.parse(e)}catch(e){return null}return null}function te(e,t,n){this.fileId=e.toString(),this.embed=t,this.uploadType=n||"File"}function ne(e,t){var n=ae(e),a=re(e),r=oe(e,t);return n&&!a&&!r}function ae(e){return!(!e||!e.trim())}function re(e){if(e){var t=e.trim().toLowerCase();return/^[a-zA-Z]{1,6}:[/\\].*$/.test(t)||function(e){return-1===e.indexOf(" ")&&/.*\.[a-zA-Z]{3,4}$/.test(e)}(t)}return!1}function oe(e,t){if(e&&t){var n=se(e),a=se(t),r=se(function(e){var t=e.split(/[/\\]/).pop();-1!==t.indexOf(".")&&(t=t.split(".").slice(0,-1).join("."));return t}(t));return a==n||r==n}return!1}function ie(e){return e=e||0,Math.round(1e3*e)/10}function le(e){const t=ie(e);return 0!==t?t:null}function se(e){return e.replace(/[\s!@#$%^&*()_+=\-[\]{};':"<>?,\\./]/g,"").trim().toLowerCase()}var ce,ue;te.prototype.id=function(){var e=[this.fileId];if(this.embed){e.push("embed");var t=this.embed.altText;"string"===f.type(t)?e.push(JSON.stringify(t)):e.push("null")}return e.join(":")},te.prototype.data=function(){return{id:this.fileId,embed:this.embed,uploadType:this.uploadType}},te.prototype.isEmbedded=function(){return null!==this.embed&&void 0!==this.embed},te.fromAltText=function(e,t){return new te(e,{altText:t})},te.fromElement=function(e,t,n){if(n=n||{},"img"===e.prop("tagName").toLowerCase()){var a=e.attr("alt");return n.hasOwnProperty("alt")&&(a=n.alt),te.fromAltText(t,a)}return new te(t)},te.fromData=function(e){return new te(e.id,e.embed,e.uploadType)},ce=window.angular,ue=window.location.href.split("/").slice(0,3).join("/"),ce.module("ally").service("AllyRestApi",["$q",function(e){var t={baseUrl:ue,lmsType:"iframe",clientId:null,courseId:null},n=null;function o(t){return function(){if(!n)return e.reject(new Error("The AllyRestApi hasn't been initialized yet. Call .init first."));n[t].apply(null,arguments)}}return{init:function(e,r,o){return o=o||function(){},t.clientId=e,t.courseId=r,i=t,I(),n=a,o()},config:function(){return t},domain:function(){return{FileReference:te}},util:function(){return r},getUploadTargetInfo:function(a){if(!n)return e.reject(new Error("The AllyRestApi hasn't been initialized yet. Call .init first."));var r=e.defer(),o="/api/v1/"+t.clientId+"/courses/"+t.courseId+"/files/"+a;return n.getRestApi().sign("POST",o,{},function(e,t){return e?r.reject(e):r.resolve(t)}),r.promise},deleteFile:o("deleteFile"),disableAlternativeFormats:o("disableAlternativeFormats"),listAvailableFormats:o("listAvailableFormats"),downloadAaasAlternativeVersion:o("downloadAaasAlternativeVersion"),downloadAlternativeVersion:o("downloadAlternativeVersion"),enableAlternativeFormats:o("enableAlternativeFormats"),getWebpageProfile:o("getWebpageProfile"),getCourseReport:o("getCourseReport"),getDownloadUrl:o("getDownloadUrl"),getEmbedInfo:o("getEmbedInfo"),getIndividualFileReport:o("getIndividualFileReport"),getIndividualRichContentReport:o("getIndividualRichContentReport"),getAaasContentReport:o("getAaasContentReport"),getFileInformation:o("getFileInformation"),getHelp:o("getHelp"),getRichContentAssociatedFiles:o("getRichContentAssociatedFiles"),getUploadOptions:o("getUploadOptions"),removeRichContentAltText:o("removeRichContentAltText"),saveMetadata:o("saveMetadata"),trackEvent:o("trackEvent"),updateRichContentAltText:o("updateRichContentAltText"),sendInstructorFeedbackExpertHelp:o("sendInstructorFeedbackExpertHelp"),sendAlternativeFormatsExpertHelp:o("sendAlternativeFormatsExpertHelp"),checkFeatureFlag:o("checkFeatureFlag")}}])}]);
//# sourceMappingURL=../../accessibleversions.281b3cb317c6834f8650.js.map